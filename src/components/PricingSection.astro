---
// Pricing Section Component
import { client } from '../../tina/__generated__/client';

// Fetch pricing plans from TinaCMS
const { data } = await client.queries.pricingConnection();
const pricingPlans = data.pricingConnection.edges.map(edge => edge.node);
---

<!--  Pricing Section -->
<section class="pricing py-5 py-lg-11 py-xl-12 bg-light-gray">
  <div class="container">
    <div class="d-flex flex-column gap-5 gap-xl-11">
      <div class="row gap-7 gap-xl-0">
        <div class="col-xl-4 col-xxl-4">
          <div class="d-flex align-items-center gap-7 py-2" data-aos="fade-right" data-aos-delay="100"
            data-aos-duration="1000">
            <span
              class="round-36 flex-shrink-0 text-dark rounded-circle bg-primary hstack justify-content-center fw-medium">07</span>
            <hr class="border-line">
            <span class="badge text-bg-dark">Pricing</span>
          </div>
        </div>
        <div class="col-xl-8 col-xxl-7">
          <div class="row">
            <div class="col-xxl-8">
              <div class="d-flex flex-column gap-6" data-aos="fade-up" data-aos-delay="100"
                data-aos-duration="1000">
                <h2 class="mb-0">Pricing plans</h2>
                <p class="fs-5 mb-0 text-opacity-70">Choose the perfect plan for your business needs. All plans include
                  our core features with flexible options to scale.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        {pricingPlans.map((plan, index) => (
          <div class="col-md-6 col-xl-4 mb-7 mb-xl-0">
            <div class={`pricing-card ${plan.popular ? 'pricing-card-active' : ''} d-flex flex-column gap-6 h-100`}
              data-aos="fade-up" data-aos-delay={`${(index + 1) * 100}`} data-aos-duration="1000">
              <div class="d-flex flex-column gap-4">
                <div class="d-flex align-items-center justify-content-between">
                  <h4 class="mb-0">{plan.name}</h4>
                  {plan.popular && (
                    <span class="badge text-bg-primary">Most Popular</span>
                  )}
                </div>
                <p class="mb-0 text-opacity-70">{plan.description}</p>
                <div class="d-flex align-items-baseline gap-2">
                  <h2 class="mb-0">{plan.currency}{plan.price}</h2>
                  <span class="text-opacity-70">{plan.period}</span>
                  {plan.originalPrice && (
                    <span class="text-decoration-line-through text-opacity-70">{plan.currency}{plan.originalPrice}</span>
                  )}
                </div>
              </div>
              <div class="d-flex flex-column gap-4">
                <ul class="list-unstyled mb-0 d-flex flex-column gap-3">
                  {plan.features.map(feature => (
                    <li class="d-flex align-items-center gap-3">
                      <iconify-icon icon="solar:check-circle-bold" class="fs-6 text-primary"></iconify-icon>
                      <span>{feature}</span>
                    </li>
                  ))}
                </ul>
                <a href={plan.buttonLink} class="btn btn-primary w-100">{plan.buttonText}</a>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>