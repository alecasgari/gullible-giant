---
// Featured Projects Section Component
import { client } from '../../tina/__generated__/client';

// Fetch projects from TinaCMS
const { data } = await client.queries.projectConnection();
const projects = data.projectConnection.edges.map(edge => edge.node);
---

<!--  Featured Projects Section -->
<section class="featured-projects py-5 py-lg-11 py-xl-12 bg-light-gray">
  <div class="d-flex flex-column gap-5 gap-xl-11">
    <div class="container">
      <div class="row gap-7 gap-xl-0">
        <div class="col-xl-4 col-xxl-4">
          <div class="d-flex align-items-center gap-7 py-2" data-aos="fade-right" data-aos-delay="100"
            data-aos-duration="1000">
            <span
              class="round-36 flex-shrink-0 text-dark rounded-circle bg-primary hstack justify-content-center fw-medium">02</span>
            <hr class="border-line">
            <span class="badge text-bg-dark">Portfolio</span>
          </div>
        </div>
        <div class="col-xl-8 col-xxl-7">
          <div class="row">
            <div class="col-xxl-8">
              <div class="d-flex flex-column gap-6" data-aos="fade-up" data-aos-delay="100"
                data-aos-duration="1000">
                <h2 class="mb-0">Featured projects</h2>
                <p class="fs-5 mb-0">A glimpse into our creativityâ€”exploring innovative designs, successful
                  collaborations, and transformative digital experiences.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="featured-projects-slider px-3">
      <div class="owl-carousel owl-theme">
        {projects.filter(project => project.featured).slice(0, 6).map((project, index) => (
          <div class="item">
            <div class="portfolio d-flex flex-column gap-6">
              <div class="portfolio-img position-relative overflow-hidden">
                <img src={project.featuredImage} alt={project.title} class="img-fluid">
                <div class="portfolio-overlay">
                  <a href={`/projects/${project._sys.filename}`}
                    class="position-absolute top-50 start-50 translate-middle bg-primary round-64 rounded-circle hstack justify-content-center">
                    <iconify-icon icon="lucide:arrow-up-right" class="fs-8 text-dark"></iconify-icon>
                  </a>
                </div>
                <div class="position-absolute top-0 end-0 m-3">
                  <span class="badge bg-warning text-dark">Featured</span>
                </div>
              </div>
              <div class="portfolio-details d-flex flex-column gap-3">
                <h3 class="mb-0">{project.title}</h3>
                <p class="mb-0 text-opacity-70 small">{project.excerpt}</p>
                <div class="d-flex align-items-center gap-2">
                  <span class="badge text-bg-primary">{project.category}</span>
                  <span class="badge text-bg-secondary">{project.status}</span>
                </div>
                {project.technologies && project.technologies.length > 0 && (
                  <div class="d-flex flex-wrap gap-1">
                    {project.technologies.slice(0, 2).map(tech => (
                      <span class="badge text-bg-dark text-white small">{tech}</span>
                    ))}
                  </div>
                )}
                <div class="hstack gap-2">
                  {project.tags.slice(0, 3).map(tag => (
                    <span class="badge text-dark border">{tag}</span>
                  ))}
                </div>
              </div>
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>